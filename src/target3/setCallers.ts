import { ethers, getNamedAccounts, network } from "hardhat"

import { networkConfig } from "../../helper-hardhat-config"

const rpcProvider = ethers.provider
const chainId = network.config.chainId!
const targetContracts = networkConfig[chainId].targetContracts
const target = targetContracts["0xb23Fbd367A95e498d97820e5ddBeb3B683E35649"]
const signers = target.signers

async function setCallers() {
  const { deployer } = await getNamedAccounts()
  const deploySig = rpcProvider.getSigner(deployer)

  let inputData = ""

  const functionHash = "0xc0ce282a"
  const arg1 = "0000000000000000000000000000000000000000000000000000000000000020"
  const arg2 = "0000000000000000000000000000000000000000000000000000000000000032"

  inputData = functionHash + arg1 + arg2
  // "0xc0ce282a00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000032000000000000000000000000d7178258b69bcace33502285fe0d5094611dd4e10000000000000000000000003235463b966275914d5bf85c4754dcfd2a4bd6950000000000000000000000003567779ab5ff236bfff34851bf4ab8af5611c9ed0000000000000000000000007ca226547f14e2654aacbce3fa31fa1eb9fdb440000000000000000000000000bdb61f01c7238fcd9af0c0d09239412f87f5933500000000000000000000000053124cf991845ac2e40b564601fd5b61dabd0322000000000000000000000000ae32219976c13198247ffd1ddddaf7250b0ec98b000000000000000000000000b7ef6eb82d4f08768bf3cff91f578df13e3b29c100000000000000000000000037081c8cb9b3647bff27579bcbb0d76c4a353cb50000000000000000000000005ba7831f4725fa8ccd2f851d572632d8cdc5d6950000000000000000000000006f72894c12b9a4d1a8a3a6d9ed11a24b65de21e70000000000000000000000004fadca4ad1dc3d57295adc4b886b0d79851d0874000000000000000000000000a3696072ad865fd43df458d3e012e173d5ac293200000000000000000000000005443e799b50caf675875ca35edcca703345d62f000000000000000000000000aff714aa3f9a143aa76cd66f8a44b2e9bee60b030000000000000000000000006b1879fb60616580e9a0d46a4b6c2426b2d2e2e200000000000000000000000024492253fbdcef8a6c0720fa1dcfbe43920bf9b70000000000000000000000001e7f595dcbfbb1af66c29bd35d2ffe702fdc988200000000000000000000000049c7966fa57bdd0b53167462eaa8e4ddcf745eb9000000000000000000000000b345d6e25ba1e83cc1b82127c3d42c822127d8a000000000000000000000000016ee6f30cd85da059790dae8d67b5f323cc9318c000000000000000000000000facd32eab0ef45f261cc52c8629db0c88974959200000000000000000000000029217583b134128787a441c0353e53c1cd2113df000000000000000000000000cd60e35ddc140279536781181a836b124a5df79f000000000000000000000000fc85548c5c0540e4f5b86f60a8ddae78bf3b7dcb000000000000000000000000dbee2d0c6171aded0c65e6b76459a784d71971a600000000000000000000000082b8d4f29161072a057e789805e6296faad39f7f000000000000000000000000f0d8d8c3470e4362fd84e5da5db016476fe8cbc30000000000000000000000001afbffa81e9bb11ac74e4b19c13fad895414df2b0000000000000000000000006b71de8b9ff00b77a6b0ea3819709dddbfac48f70000000000000000000000004826f20d8dbc1348dd6e7e643cb0ac47c566c7f9000000000000000000000000fdf0217c1a23abfe2eef5b98a216c01b648ff47e0000000000000000000000005689ee6420367ad1b591689b1835d0e6b5c948da000000000000000000000000abf7833565cc116f605e44bc07c517569b23ea7a0000000000000000000000009626618043348156f3de6661de9e2e11438361e40000000000000000000000005add820725fe2d97ee1ce2e1c2ea2b3741c4c06a0000000000000000000000004b1ec619fdb40f63c3aaf2e8f95994799d86de3e000000000000000000000000d53a7a311954c9cead810b587bcba08f0fcbbf0800000000000000000000000020a92eaabd9ac054787f7c636e85a519c4f82c71000000000000000000000000edf66abfc533e14e4208c3a4f077ff32357ea7740000000000000000000000002bd8953298e623bde115f1b191b676c53c9a6186000000000000000000000000f9421e95290a1778c8b0362c51cecd0d0f948de20000000000000000000000007d7140424194fe2322ef3a698df892109a8869670000000000000000000000003a40f2018f09d570947eba70c9cbfb428a82d678000000000000000000000000fa9628a08d95dc24c8a61e13e7d130a7f5fc6a5b0000000000000000000000008e30d079c50b7e1341ff849f82e561b8e4a2c31e00000000000000000000000079eb95aa4f2ef7883487649e02c152e553f8433c0000000000000000000000009507ed4443648a4f92f3200423a0268fc6127d5a00000000000000000000000044cdc2d3f73c76c9cbb097fff3bbb261ae850f6e000000000000000000000000a76aaa5c2c6d0c3b1e640ddcb222e36b1b004944"
  // ""
  // "0xc0ce282a00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000032000000000000000000000000035b1f0880a187e5ca143271a8e1463e67da2c460000000000000000000000008f771bc9f030babfc4a0dc83cef4ad107ca1e6fe000000000000000000000000ff3d09c29ba32426eb1a70317cbe509985eedfea00000000000000000000000016a799a79f06abd5fcb31fe658fe6307f253066f000000000000000000000000a9f4b08c370232a9a121eaa363760c7f47366f490000000000000000000000001fae2390e14050452b2f741734152948e43435d5000000000000000000000000b0d4dab17eb36ba08b95cf39cb18a244c4f20be8000000000000000000000000e9c759c21698db9c3331445138b10451c4dae8dc000000000000000000000000b1538b63efb7b03ae0f7834dea1e1b73ddce6c5a000000000000000000000000f44bd91bc1f5abe20ddc6621d01e052dc617bbc9000000000000000000000000a6ea88affa8c61c79f46ccaf8b20c6f85f71050d000000000000000000000000942b4811f13feb4256d7c277910d783978103fda0000000000000000000000006f0a8b7814f39176a976bb17a3bbf47533068255000000000000000000000000471d4c550f4d8c8d88cc64c254a2457796da6102000000000000000000000000441ae53bae120b77054968846da42693794295a6000000000000000000000000137c8b1f8f7dfb67ca67292611c0cc55697cdcfd0000000000000000000000001ec45b8f4c50237398ae202f4166a05d32dae8af000000000000000000000000a27eb859af2551064b554c34239d6278e7ece34a000000000000000000000000e357457e09b7553d36c3bf701337154dd1597d1d000000000000000000000000dfd00bf3c70f196839bee0c8106424ea6e8b8d4f000000000000000000000000ba61ef349385c14684c3c2beeeb52806905e3b55000000000000000000000000054c0b76c5c79868dbd903a28945f9006be22b0c00000000000000000000000051c8bce4fa9b056f08cd47705d09fef9c549a73d0000000000000000000000000ccfeb85438de0615cf7c1bcc51c0e291cf53a160000000000000000000000008f9e5057fd0bb635a7ebad201209093fd3dc33fa000000000000000000000000aca106016f6d3967976ea6932f61d77925b083e60000000000000000000000004baeb6731b5a3e9dc59121c9c67fcbbfb684c969000000000000000000000000ad39be6a2d09088089ef96d9926363abcc0a7e43000000000000000000000000e62998da8e14304c70f99866ce8ae65bf097afe4000000000000000000000000563f5e5b8e0981f309db2f06165ec9489b2bf3160000000000000000000000003776fb48a9e50acca70f752333bae8bc742f8ec6000000000000000000000000be3a89cec91049c10630d6f44f1759536bcb3d5400000000000000000000000019c78a008f9bad6a14b682267a9d5fa82d85da1c000000000000000000000000cc82bec4bfbfe70412c0b8e00a0cfbfb8643b827000000000000000000000000c51cc8929d2a5a8d59bb1e713bcff8d189eb0225000000000000000000000000853d6a05e206a2564e9f053aa7d16aa2ef59bb6e000000000000000000000000f1039360d71689faa16bfd1ac4f143f716952f26000000000000000000000000e0c2deadb242d9064903b001c66212a318111ee3000000000000000000000000ad0224facc73c4098b299ce9810f5ad82f1e265e00000000000000000000000092d420d7eea5c80fec70814f42559767b45ab143000000000000000000000000ef690dd33011e1a6d09cd58f24239c83c0f5737d0000000000000000000000001b156fa692455707be8daae2d818d38cc307ad6f0000000000000000000000009a22a847466eb566c9c645ed602e39ae51d7914f0000000000000000000000001f167980a744c80029883312a59a0e592a4d0e97000000000000000000000000fd362a28b086aee786c33cb9c3440292ef7004830000000000000000000000006cb2b086b7f44d6c0a9b54c12327fb7e16b097be0000000000000000000000003d67caa8fbd21cf7f42e20158c3be5777c26f34a0000000000000000000000009e29b1c57a1a335c43a336de58b21c998a339a92000000000000000000000000bf639597e5e905677097e371c745c6677d7fb460000000000000000000000000c104a1638534aa7f3a9dee92937f613197e58502"
  // ""

  for (const addr in signers) {
    // console.log(signers[addr], await (await rpcProvider.getSigner(signers[addr])).getAddress())
    const sig = await rpcProvider.getSigner(signers[addr])
    const sigAddr = await sig.getAddress()
    const sigAddrPadded = ethers.utils.hexZeroPad(sigAddr, 32)
    inputData = ethers.utils.hexConcat([inputData, sigAddrPadded])
  }

  const tx = await deploySig.sendTransaction({
    to: target.copyContractAddr,
    data: inputData,
    maxFeePerGas: 102000000000,
    maxPriorityFeePerGas: 1000000000,
  })

  const txReceipt = await tx.wait()
  console.log(`Transaction hash: ${txReceipt.transactionHash}`)
}

setCallers().catch(error => {
  console.error(error)
  process.exitCode = 1
})
